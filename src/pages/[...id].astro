---
/**
 * Dynamic catch-all route for rendering individual documents.
 * Matches any path like /library/principles/emotional-sovereignty
 */
import ArticleLayout from "@layouts/ArticleLayout.astro";
import { getBacklinksFor, getDocuments } from "@lib/documents";
import type { Document } from "@models/documents";

export async function getStaticPaths() {
  const documents = getDocuments();
  return documents.map((doc) => ({
    params: { id: doc.canonical.replace(/^\//, "") },
    props: doc,
  }));
}

const doc = Astro.props as Document;
const backlinks = getBacklinksFor(doc.canonical);
---

<ArticleLayout document={doc} backlinks={backlinks} />
